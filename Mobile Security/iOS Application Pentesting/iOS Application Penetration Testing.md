# iOS Application Penetration Testing

## Setting Up the Environment for iOS Apps Penetration Testing
To perform the iOS apps penetration testing, first you need to jailbreak the iPhone. The jailbreaking process is explained in the previous section. You may pen test iOS apps either on the iPhone itself or using an iOS Simulator. To test apps on an iOS Simulator, you are advised to install the Xcode app development kit on your workstation (Mac). Setup a wireless network connection for the iOS device and the system installed with iOS simulator. Configure and launch iOS simulator in Xcode IDE. 

- **Xcode**  
  The iOS applications may be developed and tested by using the Xcode development kit that is recommended to be downloaded and installed on the iOS devices. This development kit consists of iOS SDK, built-in source code editor, GUI editor, Xcode IDE, iOS simulator, instruments, and the latest OS X and iOS SDKs. The iOS simulator is used for testing the iOS applications.

#### Environment Setup 
1. **Installing Xcode**  
   The Xcode may be installed either from app store or through the Apple developer site  
   <https://developer.apple.com/xcode>
2. **Installing iOS simulator**  
   1. Open Xcode, a welcome window appears, click on “Create a new Xcode project.”
   2. “Choose a temple for your new project” window appears. Under “iOS” tab select “Single View Application” and click Next.
   3. “Choose options for your new project” window appears. Fill in the fields, “Product Name” and leave other fields as default and click Next and then Create.
   4. The profile that you have created appears on the screen. Below Deployment Info settings, choose a device from the “Devices” options.
   5. Click on the “iPhone” tab on the top, a list will be displayed. You may choose a device you want to install.
   6. Click on the play icon (first icon from the left) to build and run the current scheme.
   7. “Build succeeded” notification appears. A simulator window appears, it takes some time to install and start a device.
3. Installing iOS app in the simulator
   1. Open a terminal window.
   2. Use the following command to get a list of available simulators on Xcode:
   ```
   $ xcrun instruments -s devices
   ```
   3. Select the device on which you want to test your app:
      ```
      $ xcrun instruments -w AB13F549-1AF6-47B9-B46F-48B601E14212
      ```
   4. In the terminal window, navigate to the folder where you have placed the target app that you want to install and then execute the following command:
      ```
      $ codesign -fs - <app_name.app>
      ```
   5. Now, execute the following command to install the target app in the running simulator:
      ```
      $ xcrun simctl install booted <app_name.app>
      ```
   6. After the completion of the installation, an app icon appears on the simulator. You may tap the icon to run the app and test it against various exploits.
    
Ters use iOS simulator to test an iOS app security and depending upon the results, further recommend some necessary changes in the app to enhance the security of the app.

#### Screenshot of iOS simulator
![Screenshot of iOS simulator](https://github.com/user-attachments/assets/1a93baab-db51-4c16-8d06-4b13f501fa21)

![SimulatorWithXcode-1](https://github.com/user-attachments/assets/1d149ffa-6f19-4c1c-9236-5ce7d791d16c)

## Before IPA Penetration Testing
The necessary prerequisites that are recommended to be installed on your system, before starting the penetration testing on the target iOS app are given below:

### Cydia 
Source: <https://cydiainstaller.net>

Cydia is an application software for Apple devices. It contains a package with jailbreaking tools, such as: Pangu or evasi0n. Cydia packet manager is used for installing restricted apps in the iOS device, after the jailbreaking process. It comes as a package with a jailbreaking tool, such as Pangu (<http://pangu.io>) or evasi0n (<http://www.evasion7.com>).

### Gdb 
Source: <https://www.gnu.org>

GDB, the GNU Project debugger, is used to analyze the runtime behavior of an iOS app. It allows you to see the back end process of a program while it is running and the reason of it getting crashed while running.

### Class Dump 
Source: <http://stevenygard.com>

Class Dump is a command-line utility for examining the Objective-C runtime information stored in Mach-O files. It generates declarations for the classes, categories, and protocols. This is the same information provided by using “otool -ov,” but presented as normal Objective-C declarations, so it is much more compact and readable.

### OpenSSH 
Source: <http://www.openssh.com>

OpenSSH is a connectivity tool for remote login with the SSH protocol. It encrypts all traffic to eliminate eavesdropping, connection hijacking, and other attacks. In addition, OpenSSH provides a large suite of secure tunneling capabilities, several authentication methods, and sophisticated configuration options. 

It is a Secure Shell based suite that is used for secure communication. This may be installed via Cydia and comes with a default username and a password. It is always recommended to change the default username and the password.

## Identify whether iPhone is Jailbroken or not
Jail breaking is the process of removing security mechanisms set by Apple to prevent malicious code from running on the device. It provides root access to the operating system and removes sandbox restrictions. Thus jailbreaking, such as rooting, comes along with many security and other risks to the iOS device. Jail breaking may create backdoors to the malware and Trojan that allows access to personal details of the target device. Moreover, your system may become more error-prone and various stability issues may arise in the device.

You need to perform jail breaking to find the vulnerabilities that could be exploited to get the access to the device. Perform jailbreaking to bypass user limitations as set by Apple, such as modifying the OS, attaining admin privileges, and installing unofficially approved apps via “side loading.” 

Jailbreaking **creates new files** on the device. Most common files that **exist** when iPhone is jailbroken are listed below:
  ```
  /private/var/stash 
  /private/var/lib/apt 
  /private/var/tmp/cydia.log 
  /private/var/lib/cydia 
  /private/var/mobile/Library/SBSettings/Themes 
  /Library/MobileSubstrate/MobileSubstrate.dylib 
  /Library/MobileSubstrate/DynamicLibraries/Veency.plist 
  /Library/MobileSubstrate/DynamicLibraries/LiveClock.plist 
  /System/Library/LaunchDaemons/com.ikey.bbot.plist 
  /System/Library/LaunchDaemons/com.saurik.Cydia.Startup.plist 
  /var/cache/apt 
  /var/lib/apt 
  /var/lib/cydia 
  /var/log/syslog 
  /var/tmp/cydia.log 
  /bin/bash 
  /bin/sh 
  /usr/sbin/sshd
  /usr/libexec/ssh-keysign 
  /usr/sbin/sshd 
  /usr/bin/sshd 
  /usr/libexec/sftp-server 
  /etc/ssh/sshd_config 
  /etc/apt 
  /Applications/Cydia.app 
  /Applications/RockApp.app 
  /Applications/Icy.app 
  /Applications/WinterBoard.app
  /Applications/SBSettings.app 
  /Applications/MxTube.app 
  /Applications/IntelliScreen.app 
  /Applications/FakeCarrier.app 
  /Applications/blackra1n.app
  ```
#### Aollowing are different ways to identify whether the iPhone is jailbroken or not: 
- Look for these **files** to determine whether the target iPhone is jailbroken or not. 
- Check for the **permissions** for the root partition; if it has read/write permissions, then the device is jailbroken.
- Check the **size** of `/etc/fstab` file, as jailbreaking of the device increases the size of this file.
- Check whether applications may **modify files** outside of its sandbox. 
- Check whether the **OpenSSH service** is running on the device. 
- Check whether **Cydia** is installed on the device and also check for the **Cydia URL scheme** (`cydia://`) used while browsing applications.

## Inspect the Plist for Sensitive Information
Source: https://developer.apple.com 

Property List (plist) is a structured text file that contains essential user preferences and the configuration information of the application. It undergoes UTF-8 encoding and the contents are structured through XML. 

The root XML node is the Dictionary that holds a set of keys and values having detailed aspects of the bundle. The system makes use of this set of keys to obtain information about your app and the way it was configured. Therefore, all the bundled executables (plug-ins, frameworks, and apps) are expected to contain an information property list file. 

Plist has two formats: ASCII and binary format. The ASCII file may be easily read by any standard text editor as the data is presented as XML. But, to read binary file, you are advised to use Property List Editor (plist editor) that may convert the binary file into ASCII format. 

You are advised to inspect all the Plist files for collecting sensitive information, such as usernames, passwords, user’s personal information, session cookies, etc. Also, you may use Plist editors, such as plutil to view or modify all the Plist files available under application’s home directory. 

### Viewing or Editing Plist Files using Property List Editors (Plist editors) 
To view or edit the contents of property list file, select the <project>-Info.plist file in your Xcode project to display the property list editor, as shown below:

<img width="680" alt="xcode_infoplist_editor_2x" src="https://github.com/user-attachments/assets/3540d4f3-fb86-478b-94ec-c1a453c40e1f" />





