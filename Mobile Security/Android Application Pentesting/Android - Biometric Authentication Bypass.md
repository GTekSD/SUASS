![Biometric-authentication](https://github.com/user-attachments/assets/af57af9f-68af-40cd-b6ad-12840f2850ad)

# Biometric Authentication Bypass in Android

Biometric Authentication is a client-side security process that verifies a user’s identity based on unique biological characteristics, such as fingerprints, facial features, iris patterns, or voice recognition.

## Android [Keystore](https://developer.android.com/privacy-and-security/keystore) system

The Android Keystore is a system that allows developers to create and store cryptographic keys in a secure container, making them difficult to extract from the device, even using advanced techniques. These cryptographic keys are stored within specialized hardware known as TEE(Trusted Execution Environment). It is quite difficult to extract the keys stored in this TEE. Even the operating system does not have direct access to this secure memory. To perform the cryptographic operations and to receive the result within this secured environment, AndroidKeystore provides APIs to manage access.

## Biometric Authentication work flow

Fingerprint authentication can be implemented using either the [FingerprintManager](https://developer.android.com/reference/android/hardware/fingerprint/FingerprintManager) or [BiometricPrompt](https://developer.android.com/reference/android/hardware/biometrics/BiometricPrompt) and nested classes that manage the authentication mechanism, and an application dialogue asking the user to authenticate. Any of the aforementioned classes are used for application authentication, allowing the user to set the device’s biometric as a replacement for the username/password flow. After successful login using username and password, the user can choose to authenticate with the device’s biometric, thus the application creates an object that is placed in the Keystore and accessed when the fingerprint is valid. As a side note, FingerprintManager and FingerprintManagerCompact are deprecated since API 28 (Android 9).


### Setup Frida:

1. Install Frida by using following commands:

    ```bash
    python -m pip install frida
    python -m pip install frida-tools
    ```

    Alternatively, you can install them directly using pip:
  
    ```bash
    pip install frida
    pip install frida-tools
    ```
2. Add frida into Environment Variables
    * Open the "Environment Variables" window
    * Select the Path variable under "System Variables" and click the "Edit" button
    * Click the "New" button
    * Insert path `%USERPROFILE%\AppData\Local\Programs\Python\Python312\Scripts` in the text field

3. Run below command to verify if Frida is installed properly
   ```
   frida -h
   ```
   Frida is properly installed if help is displayed.

### Setup ADB - Android Debug Bridge

Check this [ADB and Fastboot setup](./ADB%20and%20Fastboot%20Setup.md) guide.

## Steps

### 1. Connect ADB Device

Connect the rooted device with wired, and run the following command to identify connected device:
```bash
adb devices
```
In result it will show the device ID as following:
```bash
PS D:\ADB-Platform-Tools\> adb devices
List of devices attached
J9AAGF002486Y9M device
```

If you are using emulator, then directly run the above command. in result it will show you the above:
```bash
PS D:\ADB-Platform-Tools\> adb devices
List of devices attached
127.0.0.1:62001 device
```

### 2. Identify CPU Architecture

First, identify the CPU architecture of the target device by executing the following command:

```bash
adb shell getprop ro.product.cpu.abi
```
In my case, it was:
```
x86
```
### 3. Download Frida Server

Download the appropriate Frida server android binary from the [official Frida releases page](https://github.com/frida/frida/releases/), based on the CPU architecture obtained in the previous step.

In my case, it was `frida-server-16.2.1-android-x86.xz`

### 4. Push Files to Device

1. Before pushing it, extract downloaded Frida server android binary file using [WinRAR](https://www.win-rar.com/download.html?&L=0) or [7-zip](https://www.7-zip.org/download.html)

In Linux, run this command:
```bash
unxz frida-server.xz
```

2. Push the extracted Frida server binary to the device:

  ```bash
  adb push frida-server-16.2.1-android-x86 /data/local/tmp
  ```

3. Make it executable:

  ```bash
  adb shell chmod 755 /data/local/tmp/frida-server-16.2.1-android-x86
  ```

### 5. Start Frida Server

Start the Frida server on the device:

```bash
adb shell "/data/local/tmp/frida-server-16.2.1-android-x86 &"
```
Alternative, If it dosent work:

```bash
adb shell /data/local/tmp/frida-server-16.2.1-android-x86
```
Still?

```bash
adb shell
cd /data/local/tmp/
./frida-server-16.2.1-android-x86
```

### 6. Check Package Name

Now, open a new terminal.

Use `frida-ps` command to identify the package name of the target application:

```bash
frida-ps -Ua
```
If it dosen't show, then open the target application and then run command again.

### 7. Execute Frida Script

Execute the Frida script to bypass biometric for the target application, but first, you need to download a javascript file, Download form [here](./Frida%20Scripts/)

Now open the targeted app that you wanted to bypass biometric, then run the following command:


Replace `com.example.app` with the actual package name of the target application.

```bash
frida -U -f com.example.app -l Android_biometric_bypass_gteksd.js
```

```bash
frida -U -f com.example.app --no-pause -l fingerprint-bypass.js
```

```bash
$ frida -U -f com.example.app --no-pause -l fingerprint-bypass-via-exception-handling.js
```

_N0te: You can remember this command as "Frida yo**u** **f**uck example.app and use **l**ub script.js"_
